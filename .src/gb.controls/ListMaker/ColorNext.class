' Gambas class file

Export
Inherits ToolButton

Property Color256 As Integer

Private $Value As Byte
Private $crs As New Variant[]

Public Sub _new()

    $crs = GetColorsRGB()
    Me.W = 32
    Me.H = 32

End

Private Function Color256_Read() As Integer

    Return $Value

End

Private Sub Color256_Write(Value As Integer)

    $Value = Value
    LoadPic($Value)

End

Private Sub LoadPic(ic As Integer)

    Dim im As Image
    Dim sDrawing As String
    Dim sBorder As String
    Dim sBack As String

    If Application.DarkTheme Then
        sBorder = "#" & Hex(Color.Darker(Color.White))
    Else
        sBorder = "#" & Hex(Color.Lighter(Color.Black))
    Endif

    sBack = "#" & Hex(Color($crs[ic][0], $crs[ic][1], $crs[ic][2]), 6)

    sDrawing = "<svg viewBox=\"0 0 48 48\" xmlns=\"http://www.w3.org/2000/svg\">"
    sDrawing &= "<path d=\"m.084919.075368h47.852623v47.840969h-47.852623z\" fill=\"none\"/>"
        "<circle cx=\"24\" cy=\"23.906908\" fill=\"" & sBack & "\" r=\"18.048223\" stroke=\"" & sBorder & "\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2.250000\"/>"
    sDrawing &= "</svg>"
    im = Image.FromString(sDrawing).Stretch(32, 32)
    Me.Picture = im.Picture

End

'' Return a colors list by the form r,g,b where each index is the DXF color integer number.

Private Function GetColorsRGB() As Variant[]

    Dim rgbx As New Variant[]

    rgbx.Add([0, 0, 0])
    rgbx.Add([255, 0, 0])
    rgbx.Add([255, 255, 0])
    rgbx.Add([0, 255, 0])
    rgbx.Add([0, 255, 255])
    rgbx.Add([0, 0, 255])
    rgbx.Add([255, 0, 255])
    rgbx.Add([255, 255, 255])
    rgbx.Add([128, 128, 128])
    rgbx.Add([192, 192, 192])
    rgbx.Add([255, 0, 0])
    rgbx.Add([255, 127, 127])
    rgbx.Add([165, 0, 0])
    rgbx.Add([165, 82, 82])
    rgbx.Add([127, 0, 0])
    rgbx.Add([127, 63, 63])
    rgbx.Add([76, 0, 0])
    rgbx.Add([76, 38, 38])
    rgbx.Add([38, 0, 0])
    rgbx.Add([38, 19, 19])
    rgbx.Add([255, 63, 0])
    rgbx.Add([255, 159, 127])
    rgbx.Add([165, 41, 0])
    rgbx.Add([165, 103, 82])
    rgbx.Add([127, 31, 0])
    rgbx.Add([127, 79, 63])
    rgbx.Add([76, 19, 0])
    rgbx.Add([76, 47, 38])
    rgbx.Add([38, 9, 0])
    rgbx.Add([38, 23, 19])
    rgbx.Add([255, 127, 0])
    rgbx.Add([255, 191, 127])
    rgbx.Add([165, 82, 0])
    rgbx.Add([165, 124, 82])
    rgbx.Add([127, 63, 0])
    rgbx.Add([127, 95, 63])
    rgbx.Add([76, 38, 0])
    rgbx.Add([76, 57, 38])
    rgbx.Add([38, 19, 0])
    rgbx.Add([38, 28, 19])
    rgbx.Add([255, 191, 0])
    rgbx.Add([255, 223, 127])
    rgbx.Add([165, 124, 0])
    rgbx.Add([165, 145, 82])
    rgbx.Add([127, 95, 0])
    rgbx.Add([127, 111, 63])
    rgbx.Add([76, 57, 0])
    rgbx.Add([76, 66, 38])
    rgbx.Add([38, 28, 0])
    rgbx.Add([38, 33, 19])
    rgbx.Add([255, 255, 0])
    rgbx.Add([255, 255, 127])
    rgbx.Add([165, 165, 0])
    rgbx.Add([165, 165, 82])
    rgbx.Add([127, 127, 0])
    rgbx.Add([127, 127, 63])
    rgbx.Add([76, 76, 0])
    rgbx.Add([76, 76, 38])
    rgbx.Add([38, 38, 0])
    rgbx.Add([38, 38, 19])
    rgbx.Add([191, 255, 0])
    rgbx.Add([223, 255, 127])
    rgbx.Add([124, 165, 0])
    rgbx.Add([145, 165, 82])
    rgbx.Add([95, 127, 0])
    rgbx.Add([111, 127, 63])
    rgbx.Add([57, 76, 0])
    rgbx.Add([66, 76, 38])
    rgbx.Add([28, 38, 0])
    rgbx.Add([33, 38, 19])
    rgbx.Add([127, 255, 0])
    rgbx.Add([191, 255, 127])
    rgbx.Add([82, 165, 0])
    rgbx.Add([124, 165, 82])
    rgbx.Add([63, 127, 0])
    rgbx.Add([95, 127, 63])
    rgbx.Add([38, 76, 0])
    rgbx.Add([57, 76, 38])
    rgbx.Add([19, 38, 0])
    rgbx.Add([28, 38, 19])
    rgbx.Add([63, 255, 0])
    rgbx.Add([159, 255, 127])
    rgbx.Add([41, 165, 0])
    rgbx.Add([103, 165, 82])
    rgbx.Add([31, 127, 0])
    rgbx.Add([79, 127, 63])
    rgbx.Add([19, 76, 0])
    rgbx.Add([47, 76, 38])
    rgbx.Add([9, 38, 0])
    rgbx.Add([23, 38, 19])
    rgbx.Add([0, 255, 0])
    rgbx.Add([127, 255, 127])
    rgbx.Add([0, 165, 0])
    rgbx.Add([82, 165, 82])
    rgbx.Add([0, 127, 0])
    rgbx.Add([63, 127, 63])
    rgbx.Add([0, 76, 0])
    rgbx.Add([38, 76, 38])
    rgbx.Add([0, 38, 0])
    rgbx.Add([19, 38, 19])
    rgbx.Add([0, 255, 63])
    rgbx.Add([127, 255, 159])
    rgbx.Add([0, 165, 41])
    rgbx.Add([82, 165, 103])
    rgbx.Add([0, 127, 31])
    rgbx.Add([63, 127, 79])
    rgbx.Add([0, 76, 19])
    rgbx.Add([38, 76, 47])
    rgbx.Add([0, 38, 9])
    rgbx.Add([19, 38, 23])
    rgbx.Add([0, 255, 127])
    rgbx.Add([127, 255, 191])
    rgbx.Add([0, 165, 82])
    rgbx.Add([82, 165, 124])
    rgbx.Add([0, 127, 63])
    rgbx.Add([63, 127, 95])
    rgbx.Add([0, 76, 38])
    rgbx.Add([38, 76, 57])
    rgbx.Add([0, 38, 19])
    rgbx.Add([19, 38, 28])
    rgbx.Add([0, 255, 191])
    rgbx.Add([127, 255, 223])
    rgbx.Add([0, 165, 124])
    rgbx.Add([82, 165, 145])
    rgbx.Add([0, 127, 95])
    rgbx.Add([63, 127, 111])
    rgbx.Add([0, 76, 57])
    rgbx.Add([38, 76, 66])
    rgbx.Add([0, 38, 28])
    rgbx.Add([19, 38, 33])
    rgbx.Add([0, 255, 255])
    rgbx.Add([127, 255, 255])
    rgbx.Add([0, 165, 165])
    rgbx.Add([82, 165, 165])
    rgbx.Add([0, 127, 127])
    rgbx.Add([63, 127, 127])
    rgbx.Add([0, 76, 76])
    rgbx.Add([38, 76, 76])
    rgbx.Add([0, 38, 38])
    rgbx.Add([19, 38, 38])
    rgbx.Add([0, 191, 255])
    rgbx.Add([127, 223, 255])
    rgbx.Add([0, 124, 165])
    rgbx.Add([82, 145, 165])
    rgbx.Add([0, 95, 127])
    rgbx.Add([63, 111, 127])
    rgbx.Add([0, 57, 76])
    rgbx.Add([38, 66, 76])
    rgbx.Add([0, 28, 38])
    rgbx.Add([19, 33, 38])
    rgbx.Add([0, 127, 255])
    rgbx.Add([127, 191, 255])
    rgbx.Add([0, 82, 165])
    rgbx.Add([82, 124, 165])
    rgbx.Add([0, 63, 127])
    rgbx.Add([63, 95, 127])
    rgbx.Add([0, 38, 76])
    rgbx.Add([38, 57, 76])
    rgbx.Add([0, 19, 38])
    rgbx.Add([19, 28, 38])
    rgbx.Add([0, 63, 255])
    rgbx.Add([127, 159, 255])
    rgbx.Add([0, 41, 165])
    rgbx.Add([82, 103, 165])
    rgbx.Add([0, 31, 127])
    rgbx.Add([63, 79, 127])
    rgbx.Add([0, 19, 76])
    rgbx.Add([38, 47, 76])
    rgbx.Add([0, 9, 38])
    rgbx.Add([19, 23, 38])
    rgbx.Add([0, 0, 255])
    rgbx.Add([127, 127, 255])
    rgbx.Add([0, 0, 165])
    rgbx.Add([82, 82, 165])
    rgbx.Add([0, 0, 127])
    rgbx.Add([63, 63, 127])
    rgbx.Add([0, 0, 76])
    rgbx.Add([38, 38, 76])
    rgbx.Add([0, 0, 38])
    rgbx.Add([19, 19, 38])
    rgbx.Add([63, 0, 255])
    rgbx.Add([159, 127, 255])
    rgbx.Add([41, 0, 165])
    rgbx.Add([103, 82, 165])
    rgbx.Add([31, 0, 127])
    rgbx.Add([79, 63, 127])
    rgbx.Add([19, 0, 76])
    rgbx.Add([47, 38, 76])
    rgbx.Add([9, 0, 38])
    rgbx.Add([23, 19, 38])
    rgbx.Add([127, 0, 255])
    rgbx.Add([191, 127, 255])
    rgbx.Add([82, 0, 165])
    rgbx.Add([124, 82, 165])
    rgbx.Add([63, 0, 127])
    rgbx.Add([95, 63, 127])
    rgbx.Add([38, 0, 76])
    rgbx.Add([57, 38, 76])
    rgbx.Add([19, 0, 38])
    rgbx.Add([28, 19, 38])
    rgbx.Add([191, 0, 255])
    rgbx.Add([223, 127, 255])
    rgbx.Add([124, 0, 165])
    rgbx.Add([145, 82, 165])
    rgbx.Add([95, 0, 127])
    rgbx.Add([111, 63, 127])
    rgbx.Add([57, 0, 76])
    rgbx.Add([66, 38, 76])
    rgbx.Add([28, 0, 38])
    rgbx.Add([33, 19, 38])
    rgbx.Add([255, 0, 255])
    rgbx.Add([255, 127, 255])
    rgbx.Add([165, 0, 165])
    rgbx.Add([165, 82, 165])
    rgbx.Add([127, 0, 127])
    rgbx.Add([127, 63, 127])
    rgbx.Add([76, 0, 76])
    rgbx.Add([76, 38, 76])
    rgbx.Add([38, 0, 38])
    rgbx.Add([38, 19, 38])
    rgbx.Add([255, 0, 191])
    rgbx.Add([255, 127, 223])
    rgbx.Add([165, 0, 124])
    rgbx.Add([165, 82, 145])
    rgbx.Add([127, 0, 95])
    rgbx.Add([127, 63, 111])
    rgbx.Add([76, 0, 57])
    rgbx.Add([76, 38, 66])
    rgbx.Add([38, 0, 28])
    rgbx.Add([38, 19, 33])
    rgbx.Add([255, 0, 127])
    rgbx.Add([255, 127, 191])
    rgbx.Add([165, 0, 82])
    rgbx.Add([165, 82, 124])
    rgbx.Add([127, 0, 63])
    rgbx.Add([127, 63, 95])
    rgbx.Add([76, 0, 38])
    rgbx.Add([76, 38, 57])
    rgbx.Add([38, 0, 19])
    rgbx.Add([38, 19, 28])
    rgbx.Add([255, 0, 63])
    rgbx.Add([255, 127, 159])
    rgbx.Add([165, 0, 41])
    rgbx.Add([165, 82, 103])
    rgbx.Add([127, 0, 31])
    rgbx.Add([127, 63, 79])
    rgbx.Add([76, 0, 19])
    rgbx.Add([76, 38, 47])
    rgbx.Add([38, 0, 9])
    rgbx.Add([38, 19, 23])
    rgbx.Add([0, 0, 0])
    rgbx.Add([51, 51, 51])
    rgbx.Add([102, 102, 102])
    rgbx.Add([153, 153, 153])
    rgbx.Add([204, 204, 204])
    rgbx.Add([255, 255, 255])
    rgbx.Add([255, 255, 255])

    Return rgbx

End
