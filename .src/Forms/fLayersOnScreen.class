' Gambas class file

Public Sub ToolButton1_Click()

End

Public Sub Form_Deactivate()

    Me.Hide

End

Public Sub Form_activate()

    Dim lay As Layer
    Dim iRow As Integer
    Dim i As Integer
    Dim sName As String = "_menuLay"
    Dim fTotalWidth As Integer

    tbvLayers.Rows.Count = gcd.CurrDrawing.arrLayers.Count
    tbvLayers.Rows.Height = 28
    tbvLayers.Columns.Count = 5 ' color, nombre, Visible, Freezada, Anclada

    tbvLayers.Columns[0].w = 18 ' color
    tbvLayers.Columns[1].w = 128 ' color
    tbvLayers.Columns[2].w = 18 ' color
    tbvLayers.Columns[3].w = 18 ' color
    tbvLayers.Columns[4].w = 18 ' color

    ' Computo el ancho que debe tener la grid
    For i = 0 To 4
        fTotalWidth += tbvLayers.Columns[i].W
    Next
    tbvLayers.w = fTotalWidth

    For i = 0 To fMain.Menus.Count - 1
        If fMain.Menus[i].Name = sName Then Break

    Next

    ' leemos de nuevo los layers
    For iRow = 0 To gcd.CurrDrawing.arrLayers.Max
        tbvLayers[iRow, 0].Picture = fMain.Menus[i].Children[iRow].Picture '   [ ].[] [ ] cm.Background = gcd.CurrDrawing.arrLayers[iRow].Colour
        tbvLayers[iRow, 1].Text = gcd.CurrDrawing.arrLayers[iRow].Name

        tbvLayers[iRow, 2].Text = IIf(gcd.CurrDrawing.arrLayers[iRow].Visible, "Y", "N")
        tbvLayers[iRow, 3].Text = IIf(gcd.CurrDrawing.arrLayers[iRow].Frozen, "Y", "N")
        tbvLayers[iRow, 4].Text = IIf(gcd.CurrDrawing.arrLayers[iRow].Locked, "Y", "N")

    Next

    ' al final
    If gcd.CurrDrawing.arrLayers.count * tbvLayers.rows[0].Height < tbvLayers.Height Then

    Else
        tbvLayers.w += 24
    End If
    Me.w = tbvLayers.W
    Me.h = tbvLayers.h + 2

End

Public Sub tbvLayers_Click()

    Debug tbvLayers.Row, tbvLayers.Column

    Dim iRow As Integer

    iRow = tbvLayers.Row
    Select Case tbvLayers.Column
        Case 0 ' color

        Case 1 ' nombre
            gcd.CurrDrawing.CurrLayer = gcd.CurrDrawing.arrLayers[iRow]
            Me.Hide
        Case 2
            gcd.CurrDrawing.arrLayers[iRow].Visible = Not gcd.CurrDrawing.arrLayers[iRow].Visible

        Case 3
            gcd.CurrDrawing.arrLayers[iRow].Frozen = Not gcd.CurrDrawing.arrLayers[iRow].Frozen

        Case 4
            gcd.CurrDrawing.arrLayers[iRow].Locked = Not gcd.CurrDrawing.arrLayers[iRow].Locked

    End Select
    tbvLayers[iRow, 2].Text = IIf(gcd.CurrDrawing.arrLayers[iRow].Visible, "Y", "N")
    tbvLayers[iRow, 3].Text = IIf(gcd.CurrDrawing.arrLayers[iRow].Frozen, "Y", "N")
    tbvLayers[iRow, 4].Text = IIf(gcd.CurrDrawing.arrLayers[iRow].Locked, "Y", "N")

    fMain.redraw

End

' Public Sub Form_Open()
'
'     Dim sb As New ScrollBar(Me)
'
'     Debug sb.w, sb.h
'
' End
