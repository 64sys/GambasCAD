' Gambas class file

Public Sub Form_Open()

    Dim factor As Float

    DrawingArea1.H = gcd.Drawing.CurrPrintStyle.PaperSizeH
    DrawingArea1.W = gcd.Drawing.CurrPrintStyle.PaperSizeW

    If DrawingArea1.h > DrawingArea1.w Then
        factor = Me.H / DrawingArea1.H
    Else
        factor = Me.w / DrawingArea1.w
    End If

    DrawingArea1.h *= factor
    DrawingArea1.w *= factor

    DrawingArea1.Left = (Me.w - DrawingArea1.w) / 2
    DrawingArea1.Top = (Me.H - DrawingArea1.h) / 2

    DrawingArea1.Refresh

End

Public Sub DrawingArea1_Draw()

    Paint.Begin(DrawingArea1)
    If gcd.Drawing.Sheet.IsModel Then fPrint.PrintModel(gcd.Drawing.CurrPrintStyle) Else fPrint.PrintSheet(gcd.Drawing.Sheet)
    Paint.End

End
