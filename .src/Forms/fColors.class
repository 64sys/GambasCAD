' Gambas class file

Public iColor As Integer = -1

Public Sub Form_Open()

    Dim i As Integer
    Dim j As Integer

    GridView1.Rows.Count = 16
    GridView1.Columns.Count = 16

    GridView1.Rows.Height = 24
    GridView1.Columns.Width = 24

    For i = 0 To GridView1.Rows.Max
        For j = 0 To GridView1.Columns.Max
            GridView1[i, j].Background = gcd.gColor[i * 16 + j]
            GridView1[i, j].tag = i * 16 + j
        Next
    Next

    ' Me.W = GridView1.W + 2
    ' Me.H = GridView1.H + 2

End

Public Sub GridView1_DblClick()
    ' sumo 1 para q el 0 sea cerrar sin elegir

    iColor = CInt(GridView1[GridView1.Row, GridView1.Column].tag) + 1
    Form_Close()'Me.Close(CInt(GridView1[GridView1.Row, GridView1.Column].tag) + 1)

End

Public Sub Form_Close()

    Me.Close(iColor)

End
