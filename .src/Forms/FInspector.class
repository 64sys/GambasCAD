' Gambas class file

Public MyState As Integer


Public Sub Form_Deactivate()

    Me.Close

End

Public Sub Form_Leave()

    Me.Close

End

' Mode va a ser usado para mostrar distintos tipos de informacion

Public Sub Run(o As Entity, Optional mode As Integer = 0)

    MyState = 0
    If Not o Then Return
    MyState = 1

    lblEntity.Text = o.gender
    ' FInspector.lblColor.Background = oEntity.gbcolor
    ' FInspector.lblColorName.TExt = oEntity.colour
    lblLayer.TExt = o.pLayer.Name
    Select o.gender
    Case "LINE"

            Me.lblPropName1.Text = ("Length")
            Me.lblProp1.Text = Left$(Str$(puntos.distancia(o.p[0], o.p[1], o.p[2], o.p[3])), 9)

            Me.lblPropName2.Text = "LineWidth"
            Me.lblProp2.Text = Str$(o.linewidth)

            Me.lblPropName3.Text = "LineType"
            Me.lblProp3.Text = Str$(o.LineType.Name)

    Case "CIRCLE"

            Me.lblPropName1.Text = ("Radious")
            Me.lblProp1.Text = Left$(Str$(o.fparam[0]), 9)

            Me.lblPropName2.Text = "LineWidth"
            Me.lblProp2.Text = Str$(o.LineWidth)

            Me.lblPropName3.Text = "LineType"
            Me.lblProp3.Text = Str$(o.LineType.Name)

    End Select

    Me.Top = Mouse.Screeny - FInspector.h / 2
    Me.Left = Mouse.ScreenX - FInspector.w / 2
    Me.Show

End

Public Sub Form_Close()

    MyState = 0 ' Closed

End
