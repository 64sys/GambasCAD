' Gambas class file

Public MyPrinter As New Printer
Public cPaperSizes As New Collection

Public Sub Printer1_Draw()

End

Public Sub btnCAncel_Click()

    Me.Close

End

Public Sub btnPrinter_Click()

    Printer1.Configure

End

Public Sub Form_Activate()

    ' Obtengo la impresion
    frmPrinter.Text = Printer1.Name

End

Public Sub Form_Open()

    ' obtengo la lista de impresoras

    Dim stxPrinters As New String[]
    Dim sSize As Variant

    stxPrinters = Printer.List

    ' ComboBox2.List.Insert(Printer1.List.Copy())

    cPaperSizes.Add("A0 841mm X 1189mm", "A0")
    cPaperSizes.Add("A1 594mm X 841mm", "A1")
    cPaperSizes.Add("A2 420mm X 594mm", "A2")
    cPaperSizes.Add("A3 297mm X 420mm", "A3")
    cPaperSizes.Add("A4 210mm X 297mm", "A4")
    cPaperSizes.Add("A5 148 mm X 210mm", "A5")
    cPaperSizes.Add("Custom size", "CU")

    For Each sSize In cPaperSizes
        cmbPaperSize.Add(sSize)
    Next

End

Public Sub btnPrint_Click()

    ' coloco todo los parametros en el estilo de impresion en uso

    With gcd.currentDrawing.CurrPrintStyle
        .ColorStyle = (1 * radGray.Value) + (2 * radColor.Value)
        .PrintScale = vlbScalePaper.Value / vlbScaleDraw.Value
        MyPrinter.Print()

    End With

End

Public Sub cmbPaperSize_Click()

    If Left(cmbPaperSize.Text, 1) = "A" Then

        vlbHeight.Enabled = False
        vlbWidth.Enabled = False
        lblHeight.Enabled = False
        lblWidth.Enabled = False
    Else
        vlbHeight.Enabled = True
        vlbWidth.Enabled = True
        lblHeight.Enabled = True
        lblWidth.Enabled = True

    Endif

End

Public Sub radWindow_Click()

    Me.Hide
    gcd.clsJobCallBack = Me ' necesitamos volver aca luego de que marque un area
    gcd.clsJob = cadSelection

End

Public Sub run()

    Me.Show

End

Public Sub ComboBox1_Click()

    If IsNumber(Left(ComboBox1.Text, 1)) Then
        lblScale1.Enabled = False
        lblScale2.Enabled = False
        vlbScaleDraw.Enabled = False
        vlbScalePaper.Enabled = False
    Else
        lblScale1.Enabled = True
        lblScale2.Enabled = True
        vlbScaleDraw.Enabled = True
        vlbScalePaper.Enabled = True
    Endif

End

Public Sub radFitCustom_Click()

End
