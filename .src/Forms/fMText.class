' Gambas class file

Public Function Start(Optional ElemToBuild As Variant, Optional Mode As Integer = -1)


    Me.Show()


End

Public Sub Form_Open()

    Dim sFont As String

    ' cargo las fonts
    For Each sFont In gcd.FontList
        cmbFont.Add(sFont)
    Next

    cmbAlignment.Add(("Top/Left"))      '1
    cmbAlignment.Add(("Top/Center"))    '2
    cmbAlignment.Add(("Top/Right"))     '3
    cmbAlignment.Add(("Center/Left"))   '4
    cmbAlignment.Add(("Centered"))      '5
    cmbAlignment.Add(("Center/Right"))  '6
    cmbAlignment.Add(("Bottom/Left"))   '7
    cmbAlignment.Add(("Bottom/Center")) '8
    cmbAlignment.Add(("Bottom/Right"))  '9

    txtRot.Text = gcd.Drawing.Headers.TEXTSIZE

End

Public Sub btnAcept_Click()

    gcd.Drawing.Headers.TEXTSIZE = txtRot.Text

    cadEntityBuilder.elem = cadMTextBuilder.eMtext
    cadEntityBuilder.Finish()
    gcd.clsJobPrevious = cadMTextBuilder
    Me.Hide

End

Public Sub btnSetPoint_Click()

    gcd.clsJob = cadSelection

    gcd.clsJobCallBack = Me
    cadSelection.Start(, cadSelection.ModePointSelection)
    Me.Hide()


End

Public Sub txtRot_MouseWheel()



    txtRot.Value += 5 * Mouse.Delta
    cadMTextBuilder.MakeMtext
    gcd.redraw
    fMain.SetFocus

End

Public Sub txtHeight_MouseWheel()

    Dim f As Float
    f = txtHeight.Value * (1 + 0.1 * Mouse.Delta)
    f = Val(Format(f, "0.00"))
    txtHeight.Value = f
    cadMTextBuilder.MakeMtext
    gcd.redraw

    fMain.SetFocus

End

Public Sub chkBold_Click()



End

Public Sub cmbAlignment_Click()

    cadMTextBuilder.MakeMtext
    gcd.redraw
    fMain.SetFocus



End

Public Sub cmbFont_Click()

    cadMTextBuilder.MakeMtext
    gcd.redraw



End

Public Sub btnCancel_Click()

    cadEntityBuilder.Cancel()
    Me.Hide


End

Public Sub form_Leave()


    fMain.SetFocus


End
