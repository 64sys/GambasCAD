' Gambas class file

Public Sub btnClose_Click()

    Me.Close

End

Public Sub Form_Open()

    ' cargo los Layers

    Dim l As Layer
    Dim i As Integer
    Dim iIcon As Integer

    tblLayers.Rows.Count = gcd.currentDrawing.oLayers.Count
    tblLayers.Rows.Height = 32
    'name show frozen locked color linewt linetype printable

    tblLayers.Columns.Count = 8
    ' acomodo la alineacion
    tblLayers.Columns[0].Alignment = Align.Left     'name
    tblLayers.Columns[1].Alignment = Align.Center   'visible
    tblLayers.Columns[2].Alignment = Align.Center     'frozen
    tblLayers.Columns[3].Alignment = Align.Center     'frozen
    tblLayers.Columns[4].Alignment = Align.Center     'color
    tblLayers.Columns[5].Alignment = Align.Right     'linewt
    tblLayers.Columns[6].Alignment = Align.Left     'linetype
    tblLayers.Columns[7].Alignment = Align.Center     'printable

    ' acomodo el ancho
    tblLayers.Columns[0].Width = 256    'name
    tblLayers.Columns[1].Width = 64     'visible
    tblLayers.Columns[2].Width = 64     'frozen
    tblLayers.Columns[3].Width = 64     'locked
    tblLayers.Columns[4].Width = 64     'color
    tblLayers.Columns[5].Width = 48     'linewt
    tblLayers.Columns[6].Width = 128     'linetype
    tblLayers.Columns[7].Width = 64     'printable

    ' titulos
    tblLayers.Columns[0].Title = ("Nombre")
    tblLayers.Columns[1].Title = ("Ver")
    tblLayers.Columns[2].Title = ("Congelar")
    tblLayers.Columns[3].Title = ("Bloquear")
    tblLayers.Columns[4].Title = ("Color")
    tblLayers.Columns[5].Title = ("Espesor")
    tblLayers.Columns[6].Title = ("Tipo de linea")
    tblLayers.Columns[7].Title = ("Imprimir")

    For Each l In gcd.currentDrawing.oLayers

        ' name
        tblLayers[i, 0].Text = l.Name
        tblLayers[i, 0].Tag = l.handle

        ' show
        If l.Visible Then
            tblLayers[i, 1].Picture = gcd.picVisibleOn
        Else
            tblLayers[i, 1].Picture = gcd.picVisibleOff
        Endif

        ' frozen
        If l.Frozen Then
            tblLayers[i, 2].Picture = gcd.picFrozenOn
        Else
            tblLayers[i, 2].Picture = gcd.picFrozenOff
        Endif

        ' locked
        If l.Locked Then
            tblLayers[i, 3].Picture = gcd.picLockedOn
        Else
            tblLayers[i, 3].Picture = gcd.picLockedOff
        Endif

        ' color
        tblLayers[i, 4].Picture = paintPlus.picCirculito(8, gcd.gColor[l.Colour], Color.ButtonForeground)

        ' linewt
        tblLayers[i, 5].Text = Format(l.LineWt, "0.00")

        ' linetype
        tblLayers[i, 6].Text = l.LineType

        ' printable

        If l.Printable Then
            tblLayers[i, 7].Picture = gcd.picPrintOn
        Else
            tblLayers[i, 7].Picture = gcd.picPrintOff
        Endif

        Inc i
    Next

End
