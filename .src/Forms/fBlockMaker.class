' Gambas class file

Private OldH As Integer
Private ActionDone As Integer
Public Const ActionInsertionPoint As Integer = 1
Public Const ActionSelectEntities As Integer = 2

Public Sub Run()

    Me.SetFocus
    Done

End

Public Sub Form_Open()

    OldH = Me.H

End

Public Sub Done()

    lblHelp.visible = False
    btnDone.Visible = False
    lblName.Visible = True
    cmbFamily.Visible = True
    cmbSubFamily.Visible = True
    txtName.Visible = True
    Me.H = OldH
    If Me.Action = Me.ActionInsertionPoint Then
        txtX.Text = Format(cadSelection.EndXr, "0.0000")
        txtY.Text = Format(cadSelection.Endyr, "0.0000")
    Endif

End

Public Sub Parameters_Click()

    If Last.name = "btnDone" Then
        Done
    Else
        Me.H = lblHelp.H + 16
        lblHelp.visible = True
        btnDone.Visible = True
        lblName.Visible = False
        cmbFamily.Visible = False
        cmbSubFamily.Visible = False
        txtName.Visible = False
        If Last.name = "btnInsertionPoint" Then
            lblHelp.Text = ("Set the insertion point")
            cadSelection.Mode = cadSelection.SelectModePoint
            gcd.clsJobCallBack = Me
            gcd.clsJob = cadSelection
            Me.Action = Me.ActionInsertionPoint

        Else If Last.name = "btnEntities" Then
            lblHelp.Text = ("Select entities for the new block")
            cadSelection.Mode = cadSelection.SelectModeEntities
            gcd.clsJobCallBack = Null
            gcd.clsJob = cadSelection
            Me.Action = Me.ActionSelectEntities

        Else If Last.name = "btnRemove" Then
            gcd.currentDrawing.oSelected.Clear

        Endif

    Endif

End
