' Gambas class file

Public Sub ComboBox1_Click()

    Dim sFilename As String
    Dim imgPreview As Image
    Dim entScale As Float
    Dim entidad As Entity
    Dim sFActor As Float = 1.5

    iconView1.Clear
    ComboBox2.Clear
    For Each sFilename In Dir(Config.BlocksLibraryPath &/ ComboBox1.Current.Text)
        If IsDir(Config.BlocksLibraryPath &/ ComboBox1.Current.Text &/ sFilename) Then
            ComboBox2.Add(sFilename)
        Else
            If LCase(File.Ext(sFilename)) <> "dxf" Then Continue
            imgPreview = New Image(80, 80, Color.Black)

            gcd.FitDxfToImage(Config.BlocksLibraryPath &/ ComboBox1.current.Text &/ sFilename, imgPreview, Config.WhiteAndBlack, 0)

            iconView1.Add(Left$(sFilename, -4), Left$(sFilename, -4), imgPreview.Picture)
        End If
    Next
    If ComboBox2.Count > 0 Then ComboBox2.Index = 0

End

Public Sub Form_Open()

    Dim sDirName As String

    For Each sDirName In Dir(Config.BlocksLibraryPath)
        If IsDir(Config.BlocksLibraryPath &/ sDirName) Then ComboBox1.Add(sDirName)
    Next
    If ComboBox1.Count > 0 Then ComboBox1.Index = 0

End

Public Sub ComboBox2_Click()

    iconView1.Clear
    Dim sFilename As String
    Dim imgPreview As Image
    For Each sFilename In Dir(Config.BlocksLibraryPath &/ ComboBox1.Current.Text &/ ComboBox2.Current.Text, "*.dxf")
        If IsDir(Config.BlocksLibraryPath &/ ComboBox1.Current.Text &/ ComboBox2.Current.Text &/ sFilename) Then Continue
        If LCase(File.Ext(sFilename)) <> "dxf" Then Continue
        '     ComboBox2.Add(sFilename)
        ' Else
        imgPreview = New Image(80, 80, Color.Black)

        gcd.FitDxfToImage(Config.BlocksLibraryPath &/ ComboBox1.current.Text &/ ComboBox2.Current.Text &/ sFilename, imgPreview, Config.WhiteAndBlack, 0)

        iconView1.Add(Left$(sFilename, -4), Left$(sFilename, -4), imgPreview.Picture)

    Next

End

' Public Sub IconView1_Drag()
'
'     Drag.Icon = iconView1.Current.Picture
'
'     iconView1.Drag(iconView1.Current.Picture)
'
' End
'
' Public Sub IconView1_DragMove()
'
'     Drag.Icon = iconView1.Current.Picture
'
'
' End

Public Sub IconView1_DblClick()

End
