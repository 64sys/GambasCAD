' Gambas class file

Public flx As Float[]

Public Function EditPoints(flxPoints As Float[], Optional Mode3D As Boolean = False, sFormat As String = "0.0000") As Boolean

    Dim n As Integer = 2
    Dim i, r As Integer

    If Mode3D Then n = 3


    grd.Header = GridView.Both
    grd.Rows.Count = flxPoints / n
    grd.Columns.Count = n

    For i = 0 To flxPoints.Max Step n
        grd.Rows[r].Title = Str(r + 1)
        grd[r, 0].Text = Format(flxPoints[i], sFormat)
        grd[r, 1].Text = Format(flxPoints[i + 1], sFormat)
        If Mode3D Then
            grd[r, 2].Text = Format(flxPoints[i + 2], sFormat)
        Endif
        Inc r
    Next

    flx = flxPoints

    Me.ShowModal()


End

Public Sub Form_Open()



End

Public Sub btnCancel_Click()

    Me.Close(False)

End

Public Sub btnAccept_Click()

    Dim n, i, r As Integer

    n = grd.Columns.Count

    For i = 0 To flx.Max Step n

        flx[i] = CFloat(grd[r, 0].Text)
        flx[i + 1] = CFloat(grd[r, 1].Text)
        If n Then
            flx[i + 2] = CFloat(grd[r, 2].Text)
        Endif
        Inc r

    Next
    Me.Close(True)

End
